METHOD_0 ( ) { java . io . File IDENT_0 = new java . io . File ( io . cdap . plugin . batch . source . IDENT_1 . IDENT_2 . METHOD_1 ( ) , STRING_0 ) ; java . lang . String IDENT_3 = STRING_1 ; java . lang . String IDENT_4 = STRING_2 ; io . cdap . cdap . test . IDENT_5 IDENT_6 = METHOD_2 ( IDENT_4 , IDENT_0 , STRING_3 , IDENT_3 , io . cdap . plugin . batch . source . IDENT_1 . IDENT_7 ) ; org . apache . avro . Schema IDENT_8 = new org . apache . avro . Schema . METHOD_3 ( ) . parse ( io . cdap . plugin . batch . source . IDENT_1 . IDENT_7 . toString ( ) ) ; org . apache . avro . IDENT_9 . IDENT_10 record = new org . apache . avro . IDENT_9 . METHOD_4 ( IDENT_8 ) . set ( STRING_4 , Integer . MAX_VALUE ) . set ( STRING_5 , Long . MAX_VALUE ) . set ( STRING_6 , IDENT_0 . getAbsolutePath ( ) ) . build ( ) ; io . cdap . cdap . test . IDENT_11 < io . cdap . cdap . api . dataset . lib . IDENT_12 > IDENT_13 = METHOD_5 ( STRING_7 ) ; org . apache . IDENT_14 . hadoop . IDENT_15 < org . apache . avro . IDENT_9 . IDENT_10 > IDENT_16 = new org . apache . IDENT_14 . avro . METHOD_6 ( new org . apache . hadoop . fs . Path ( IDENT_0 . getAbsolutePath ( ) ) , IDENT_8 ) ; IDENT_16 . write ( record ) ; IDENT_16 . close ( ) ; IDENT_13 . METHOD_7 ( ) ; IDENT_6 . METHOD_8 ( IDENT_17 . IDENT_18 ) . METHOD_9 ( IDENT_19 . IDENT_20 , 5 , TimeUnit . IDENT_21 ) ; java . util . List < io . cdap . cdap . api . data . format . IDENT_22 > expected = com . google . common . collect . ImmutableList . of ( io . cdap . cdap . api . data . format . IDENT_22 . builder ( io . cdap . plugin . batch . source . IDENT_1 . IDENT_7 ) . set ( STRING_4 , Integer . MAX_VALUE ) . set ( STRING_5 , Long . MAX_VALUE ) . set ( STRING_6 , IDENT_0 . METHOD_10 ( ) . toString ( ) ) . build ( ) ) ; io . cdap . cdap . test . IDENT_11 < io . cdap . cdap . api . dataset . table . IDENT_23 > IDENT_24 = METHOD_5 ( IDENT_3 ) ; java . util . List < io . cdap . cdap . api . data . format . IDENT_22 > output = io . cdap . cdap . IDENT_25 . mock . batch . IDENT_26 . METHOD_11 ( IDENT_24 ) ; "<AssertPlaceHolder>" ; METHOD_12 ( ( IDENT_4 + STRING_7 ) , io . cdap . plugin . batch . source . IDENT_1 . IDENT_7 ) ; } METHOD_11 ( org . apache . IDENT_27 . IDENT_28 . IDENT_29 ) { org . apache . avro . Schema IDENT_8 = new org . apache . avro . Schema . METHOD_3 ( ) . parse ( io . cdap . plugin . batch . IDENT_30 . IDENT_31 . toString ( ) ) ; java . util . Map < java . lang . String , java . lang . Integer > IDENT_32 = new java . util . HashMap ( ) ; for ( org . apache . IDENT_27 . IDENT_28 . IDENT_29 file : IDENT_33 . list ( ) ) { java . lang . String IDENT_34 = file . getName ( ) ; if ( IDENT_34 . METHOD_13 ( STRING_8 ) ) { org . apache . avro . io . IDENT_35 < org . apache . avro . IDENT_9 . IDENT_10 > IDENT_36 = new org . apache . avro . IDENT_9 . METHOD_14 ( IDENT_8 ) ; org . apache . avro . file . IDENT_37 < org . apache . avro . IDENT_9 . IDENT_10 > IDENT_38 = new org . apache . avro . file . METHOD_15 ( file . METHOD_16 ( ) , IDENT_36 ) ; for ( org . apache . avro . IDENT_9 . IDENT_10 record : IDENT_38 ) { IDENT_32 . put ( record . get ( STRING_9 ) . toString ( ) , ( ( java . lang . Integer ) ( record . get ( STRING_10 ) ) ) ) ; } IDENT_38 . close ( ) ; } else if ( IDENT_34 . METHOD_13 ( STRING_11 ) ) { org . apache . hadoop . fs . Path IDENT_39 = new org . apache . hadoop . fs . Path ( file . toString ( ) ) ; org . apache . IDENT_14 . avro . IDENT_40 . Builder < org . apache . avro . IDENT_9 . IDENT_10 > IDENT_41 = org . apache . IDENT_14 . avro . IDENT_40 . builder ( IDENT_39 ) ; org . apache . IDENT_14 . hadoop . IDENT_42 < org . apache . avro . IDENT_9 . IDENT_10 > reader = IDENT_41 . build ( ) ; org . apache . avro . IDENT_9 . IDENT_10 record = reader . read ( ) ; while ( record != null ) { IDENT_32 . put ( record . get ( STRING_9 ) . toString ( ) , ( ( java . lang . Integer ) ( record . get ( STRING_10 ) ) ) ) ; record = reader . read ( ) ; } } } return IDENT_32 ; }
org . junit . Assert . assertEquals ( expected , output ) 